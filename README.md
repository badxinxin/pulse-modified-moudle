# 智能弹药课程设计作业
## <p align="center">弹箭飞行弹道模型仿真</p>

本项目使用Matlab进行弹箭飞行弹道模型的仿真。所使用的Matlab版本为R2022a，同时需要安装Simulink。

### <p align="center">无脉冲作用弹箭飞行弹道模型</p>

执行以下步骤进行仿真：

运行 beforesim.m 脚本。

运行 program_flight.slx Simulink模型。

运行 afterplot.m 脚本进行结果绘图。

<br>用户自定义配置

在 ProgramDynamics.m 的第69行按照注释赋予初始值。

### <p align="center">脉冲作用弹箭飞行弹道模型</p>

执行以下步骤进行仿真：

运行 beforesim.m 脚本。

运行 program_flight.slx Simulink模型。

运行 afterplot.m 脚本进行结果绘图。

<br>用户自定义配置

在 ProgramDynamics.m 的第69行按照注释赋予初始值。

在Beforesim.m 的第26行设置发动机作用位置。

在Program_flight.slx 的Pulsemodify子系统中修改Tm，Tj，Fp，Engine，K参数。 
![20230615172827](https://github.com/badxinxin/pulse-modified-moudle/assets/131271278/cded5963-e879-4467-8a98-8a453a5f8f01)

## 6.15更新

哎，把积分判决改成微分判决就好了，果然微分比积分简单，哎

## 6.16更新

急晕了，老师说我求解器有问题解得是导数不是状态量，哎，但确实不是这个问题。

在模型的初始阶段，俯仰角的值并没有按照预期进行初始化。尽管在定义x0时为俯仰角设定了初始值，但Simulink仿真开始时，俯仰角的值却是0。

我尝试了多种方法进行调试，包括更改初始状态向量x0的顺序，查看S-function的调用路径，以及尝试在仿真开始之前查看俯仰角的值。然而，这些尝试并没有找到问题的根源。

然后，我对照上学期做的实际弹道模型，顺着俯仰角逐级检查，看到了S-function的输出向量模块的接口中alpha的顺序不对。alpha并没有被放在向量拆分器的最后，这可能是导致问题的原因。更改了alpha的顺序后，俯仰角终于不为0了。不过仿真结果开始耍宝了，俯仰角、wz和alpha在仿真过程中出现了大的振荡。

还好我有备份，我直接选择读档重做^ ^

知道问题所在了就直接去改向量顺序了，然后结果就是之前beta版本的锯齿波，很容易看出来是在脉冲力启动后产生的，需要对脉冲修正系统进行微调。

在使用display观察输出脉冲力时，发现脉冲力在整个低于2000m的下落段一直在0和2000之间反复横跳，早就超过了预定的级数限制，于是想着优化一下判定启动次数的算法。

首先修改了函数的结构，将脉冲力的计算和脉冲次数的更新放在了同一个函数中。同时，添加了新的输入参数，包括发动机数量和脉冲次数。

然后，出现一个问题，即脉冲开始时间并不会随着时间的推移而增加。为了解决这个问题，引入了一个新的输入参数dt，表示仿真的时间步长，并用它来更新脉冲开始时间。

最后，我注意到，在飞行器开始下降且高度低于2000m的时候，脉冲计数算作一次了，可能会导致发动机少作用一次。为了解决这个问题，使用memory模块将初值设为-1，这样刚进入2000m时判定条件完成加1，进入循环时刚好为0，可以启动发动机。

# 求求用完给我点个星星，这对我很重要！
